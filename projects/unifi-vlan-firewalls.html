<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UniFi VLAN Segmentation & Firewalls — MRDTech</title>
  <link rel="icon" href="../favicon.png" />
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html { scroll-behavior: smooth; }
    code { background: rgba(15,23,42,0.6); padding: 3px 6px; border-radius: 6px; }
    pre { background: rgba(15,23,42,0.85); padding: 16px; border-radius: 10px; overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid rgba(51,65,85,0.85); padding: 8px 12px; }
    th { background: rgba(15,23,42,0.9); }
    tr:nth-child(even) td { background: rgba(15,23,42,0.6); }
  </style>
</head>

<body class="bg-[#0b0c0e] text-slate-200">

  <!-- Header -->
  <header class="border-b border-slate-800 bg-black/40 backdrop-blur sticky top-0 z-40">
    <div class="max-w-5xl mx-auto px-5 py-4 flex justify-between items-center">
      <a href="../index.html#projects" class="text-slate-100 font-semibold">← Back to Projects</a>
      <span class="text-slate-500 text-sm">UniFi VLAN Guide</span>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-5 py-10">

    <!-- Hero -->
    <h1 class="text-3xl font-bold text-slate-100">
      UniFi VLAN Segmentation & Firewall Design
    </h1>

    <p class="mt-4 text-slate-400 leading-relaxed text-lg max-w-3xl">
      A practical, opinionated UniFi design for isolating Home, Guest, IoT, and VPN networks
      with proper north–south exposure (Plex, WireGuard, Reverse Proxy) and strict east–west
      segmentation. This layout mirrors my homelab but also applies to SMB and enterprise.
    </p>

    <hr class="my-8 border-slate-800" />

    <!-- 1. Design Goals -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-emerald-400">1. Design Goals</h2>

      <ul class="mt-4 list-disc list-inside space-y-2 text-slate-300">
        <li>Fully isolate <strong>Home</strong> from IoT & Guest networks.</li>
        <li>Allow controlled access (e.g., IoT cameras → NVR, TVs → Plex).</li>
        <li>Force internal DNS usage via AdGuard/Unbound.</li>
        <li>Expose only required services to WAN (WireGuard, NGINX/Proxy).</li>
        <li>Keep firewall policies clean, predictable, and maintainable.</li>
      </ul>
    </section>

    <!-- 2. VLAN Layout -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-emerald-400">2. VLAN & Subnet Layout</h2>

      <p class="mt-3 text-slate-300">
        Below is the structure used in my environment. Adjust IDs, names, and subnets to fit yours.
      </p>

      <div class="mt-4 rounded-xl border border-slate-800 bg-slate-900/60 p-4">
        <h3 class="font-semibold text-slate-200 mb-3">VLAN Definitions</h3>
        <div class="overflow-x-auto">
          <table>
            <thead>
              <tr>
                <th>VLAN</th>
                <th>Name</th>
                <th>Subnet</th>
                <th>Use Case</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Home</td>
                <td>10.10.10.0/24</td>
                <td>PCs, Servers, Lab, Admin Devices</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Guest</td>
                <td>192.168.20.0/24</td>
                <td>Guests → Internet Only</td>
              </tr>
              <tr>
                <td>3</td>
                <td>PrivateInternetAccess</td>
                <td>192.168.30.0/24</td>
                <td>Forced egress through VPN</td>
              </tr>
              <tr>
                <td>4</td>
                <td>IoT</td>
                <td>192.168.40.0/24</td>
                <td>TVs, Cameras, Smart Devices</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- 3. Create Networks -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-emerald-400">3. Create Networks in UniFi</h2>

      <ol class="mt-4 list-decimal list-inside space-y-2 text-slate-300">
        <li>Open UniFi Network.</li>
        <li>Go to <strong>Settings → Networks → Create New Network</strong>.</li>
        <li>For each VLAN:
          <ul class="mt-2 list-disc list-inside ml-5 space-y-1">
            <li>Name (e.g. <code>Home</code>)</li>
            <li>Purpose: <strong>Corporate</strong></li>
            <li>VLAN ID: matches table above</li>
            <li>Gateway/Subnet: <code>x.x.x.1/24</code></li>
            <li>DHCP: enable for client VLANs</li>
          </ul>
        </li>
      </ol>

      <p class="mt-4 text-slate-400 text-sm">
        VLANs exist now, but without firewall rules everything can still talk freely.
      </p>
    </section>

    <!-- 4. Assign VLANs -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-emerald-400">4. Assign VLANs to Switch Ports & Wi-Fi</h2>

      <h3 class="mt-4 font-semibold text-slate-200">Switch Ports</h3>
      <ul class="mt-2 list-disc list-inside text-slate-300 space-y-2">
        <li>Create <strong>Port Profiles</strong> for Home, Guest, IoT, VPN.</li>
        <li>Use trunk uplinks between switches/APs.</li>
        <li>Assign ports based on device role: IoT → IoT, Servers → Home.</li>
      </ul>

      <h3 class="mt-6 font-semibold text-slate-200">Wi-Fi SSIDs</h3>
      <ul class="mt-2 list-disc list-inside text-slate-300 space-y-2">
        <li><strong>Home</strong> → VLAN 1</li>
        <li><strong>Guest</strong> → VLAN 2 (with guest isolation)</li>
        <li><strong>IoT</strong> → VLAN 4 (WPA2 only if required)</li>
      </ul>
    </section>

    <!-- 5. Firewall Strategy -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-emerald-400">5. Firewall Strategy</h2>

      <p class="mt-3 text-slate-300">
        UniFi processes rules top-to-bottom. I structure my rules into logical “zones”:
      </p>

      <ul class="mt-3 list-disc list-inside space-y-2 text-slate-300">
        <li><strong>LAN IN</strong> — VLAN → VLAN traffic</li>
        <li><strong>LAN LOCAL</strong> — VLAN → Gateway</li>
        <li><strong>WAN IN</strong> — Internet → LAN</li>
        <li><strong>WAN OUT</strong> — LAN → Internet</li>
      </ul>

      <p class="mt-4 text-slate-400 text-sm">
        The fundamental rule-set is:
      </p>

      <ol class="mt-2 list-decimal list-inside text-slate-300 space-y-1">
        <li>Deny inter-VLAN by default</li>
        <li>Allow only required flows</li>
        <li>Allow management devices to reach UniFi / gateway</li>
      </ol>
    </section>

    <!-- 6. Example Rules -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-emerald-400">6. Example Firewall Rules</h2>

      <p class="mt-3 text-slate-300">
        These are templates — adapt as needed.
      </p>

      <h3 class="font-semibold text-slate-200 mt-6">Deny East/West by Default</h3>
      <pre>Rule Name: Block IoT → Home
Direction: LAN IN
Interface: IoT
Action: Drop
Source: 192.168.40.0/24
Destination: 10.10.10.0/24
Comment: Prevent IoT access into Home</pre>

      <pre>Rule Name: Block Guest → RFC1918
Direction: LAN IN
Interface: Guest
Action: Drop
Source: 192.168.20.0/24
Destination: Any RFC1918
Comment: Guest → Internet only</pre>

      <h3 class="font-semibold text-slate-200 mt-8">Allow Required Flows</h3>

      <pre>Rule Name: Home → IoT Cameras
Direction: LAN IN
Interface: IoT
Action: Accept
Source: 10.10.10.0/24
Destination: Camera VLAN / IPs
Ports: 80, 443, 554
Comment: Permit camera viewing</pre>

      <pre>Rule Name: IoT → DNS/NTP
Direction: LAN OUT
Action: Accept
Source: 192.168.40.0/24
Destination: Internal DNS + NTP
Ports: UDP 53, 123
Comment: Controlled egress only</pre>
    </section>

    <!-- 7. DNS Control -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-emerald-400">7. DNS & Egress Control</h2>

      <p class="mt-3 text-slate-300">Prevent DNS bypass:</p>

      <ol class="mt-3 list-decimal list-inside space-y-3 text-slate-300">
        <li>Set DHCP DNS to internal resolvers (AdGuard, Unbound).</li>
        <li>Create a WAN OUT drop rule:</li>
      </ol>

<pre>Rule Name: Block Direct DNS to Internet
Direction: WAN OUT
Action: Drop
Source: All RFC1918
Destination: Any
Ports: TCP/UDP 53, 853
Comment: Force internal DNS usage</pre>
    </section>

    <!-- 8. Testing -->
    <section class="mb-12">
      <h2 class="text-2xl font-semibold text-emerald-400">8. Testing & Validation</h2>

      <ul class="mt-3 list-disc list-inside space-y-2 text-slate-300">
        <li>Guest devices: confirm internet works, LAN access blocked.</li>
        <li>Home devices: confirm cameras & Plex work as expected.</li>
        <li>Verify DNS path with:</li>
      </ul>

<pre>nslookup google.com
tracert 8.8.8.8</pre>

    </section>

    <!-- Footer -->
    <footer class="py-10 text-center text-xs text-slate-500">
      © <span id="y"></span> Michael Dziegiel — Built with GitHub Pages
    </footer>
  </main>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>

</body>
</html>
